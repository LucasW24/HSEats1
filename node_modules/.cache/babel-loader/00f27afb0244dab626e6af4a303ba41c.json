{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\ZB56\\\\Documents\\\\hseats\\\\HSEats1\\\\src\\\\App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { BrowserRouter, Switch, Route } from 'react-router-dom';\nimport axios from 'axios';\nimport Loading from './components/Loading';\nimport Home from './views/Home';\nimport AuthContext from './auth/AuthContext';\nimport Login from './auth/Login';\nimport Signup from './auth/Signup';\nimport Verify from './auth/Verify';\nimport ForgotPassword from './auth/ForgotPassword';\nimport ResetPassword from './auth/ResetPassword';\nimport Settings from './auth/Settings';\nimport './App.css';\n\nconst App = () => {\n  _s();\n\n  var _auth$user, _auth$user2;\n\n  const [auth, setAuth] = useState({\n    isAuth: false,\n    loading: true,\n    fetched: false\n  });\n  useEffect(() => {\n    document.title = \"HSEates\";\n\n    if (!auth.user && !auth.fetched) {\n      console.log('test token');\n      testToken();\n    }\n\n    if (auth.toFetch) {\n      testToken();\n      console.log(\"hi there\");\n    }\n\n    console.log(auth);\n  }, [auth]);\n\n  const testToken = async () => {\n    const token = localStorage.getItem('token');\n\n    if (!token) {\n      setAuth({\n        isAuth: false,\n        loading: false,\n        fetched: true\n      });\n    } else {\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n\n      try {\n        const res = await axios.get(`${process.env.REACT_APP_AUTH_API}/user/?timestamp=${new Date().getTime()}`);\n        console.log(res.data);\n\n        if (!res.data.errors) {\n          setAuth({\n            isAuth: true,\n            user: res.data,\n            loading: false,\n            fetched: true\n          });\n        } else {\n          console.log(\"set to false\");\n          localStorage.removeItem(\"token\");\n          setAuth({\n            isAuth: false,\n            loading: false,\n            fetched: true\n          });\n        }\n      } catch (err) {\n        localStorage.removeItem(\"token\");\n        console.log(\"set to false\");\n        setAuth({\n          isAuth: false,\n          loading: false,\n          fetched: true\n        });\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      auth,\n      setAuth\n    },\n    children: /*#__PURE__*/_jsxDEV(BrowserRouter, {\n      children: /*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/verify/:token\",\n          component: Verify\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/forgot-password\",\n          component: ForgotPassword\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/reset-password/:token\",\n          component: ResetPassword\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/login\",\n          component: Login\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/signup\",\n          component: Signup\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/settings\",\n          component: Settings\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/\",\n          component: Home\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this), ((_auth$user = auth.user) === null || _auth$user === void 0 ? void 0 : _auth$user.role) === \"teacher\" ? /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: ((_auth$user2 = auth.user) === null || _auth$user2 === void 0 ? void 0 : _auth$user2.role) === \"student\" ? /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n};\n\n_s(App, \"bXvfFmQroEHZeN1wKGje2VNq+kA=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["C:/Users/ZB56/Documents/hseats/HSEats1/src/App.js"],"names":["React","useState","useEffect","BrowserRouter","Switch","Route","axios","Loading","Home","AuthContext","Login","Signup","Verify","ForgotPassword","ResetPassword","Settings","App","auth","setAuth","isAuth","loading","fetched","document","title","user","console","log","testToken","toFetch","token","localStorage","getItem","defaults","headers","common","res","get","process","env","REACT_APP_AUTH_API","Date","getTime","data","errors","removeItem","err","role"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport {BrowserRouter, Switch, Route} from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nimport Loading from './components/Loading';\r\n\r\nimport Home from './views/Home';\r\n\r\nimport AuthContext from './auth/AuthContext';\r\nimport Login from './auth/Login';\r\nimport Signup from './auth/Signup';\r\nimport Verify from './auth/Verify';\r\nimport ForgotPassword from './auth/ForgotPassword';\r\nimport ResetPassword from './auth/ResetPassword';\r\nimport Settings from './auth/Settings';\r\n\r\nimport './App.css';\r\n\r\nconst App = () => {\r\n  const [auth, setAuth] = useState({isAuth: false, loading: true, fetched: false})\r\n\r\n  useEffect(() => {\r\n    document.title = \"HSEates\"\r\n\r\n    if (!auth.user && !auth.fetched){\r\n      console.log('test token')\r\n      testToken()\r\n    }\r\n    if (auth.toFetch){\r\n      testToken()\r\n      console.log(\"hi there\")\r\n    }\r\n    console.log(auth)\r\n\r\n  }, [auth])\r\n\r\n  const testToken = async () => {\r\n    const token = localStorage.getItem('token')\r\n\r\n    if(!token){\r\n      setAuth({isAuth: false, loading: false, fetched: true})\r\n\r\n    } else {\r\n      axios.defaults.headers.common['Authorization'] =`Bearer ${token}`\r\n\r\n      try{\r\n        const res = await axios.get(`${process.env.REACT_APP_AUTH_API}/user/?timestamp=${new Date().getTime()}`)\r\n        console.log(res.data)\r\n\r\n        if (!res.data.errors){\r\n          setAuth({isAuth: true, user: res.data, loading: false, fetched: true})\r\n\r\n        } else {\r\n          console.log(\"set to false\")\r\n          localStorage.removeItem(\"token\")\r\n          setAuth({isAuth: false, loading: false, fetched: true})\r\n        }\r\n      } catch (err) {\r\n        localStorage.removeItem(\"token\")\r\n        console.log(\"set to false\")\r\n        setAuth({isAuth: false, loading: false, fetched: true})\r\n      }\r\n    }\r\n  } \r\n\r\n\r\n  return (\r\n    <AuthContext.Provider value={{auth, setAuth}}>\r\n      <BrowserRouter>\r\n        <Switch>\r\n          <Route exact path=\"/verify/:token\" component={Verify}/>\r\n          <Route exact path=\"/forgot-password\" component={ForgotPassword}/>\r\n          <Route exact path=\"/reset-password/:token\" component={ResetPassword}/>\r\n          <Route exact path=\"/login\" component={Login}/>\r\n          <Route exact path=\"/signup\" component={Signup}/>\r\n          <Route exact path=\"/settings\" component={Settings}/>\r\n\r\n          {/* general routes */}\r\n          <Route exact path=\"/\" component={Home}/>\r\n          \r\n          {auth.user?.role === \"teacher\"?\r\n            <div>\r\n              {/* admin routes */}\r\n            </div>\r\n          :\r\n            <div>\r\n              {auth.user?.role === \"student\"?\r\n                <div>\r\n                  {/* student routes */}\r\n                </div>\r\n              :\r\n                <div>\r\n                  {/* not logged in routes */}\r\n                </div>\r\n              }\r\n            </div>\r\n          }\r\n          \r\n        </Switch>\r\n      </BrowserRouter>\r\n    </AuthContext.Provider>\r\n  )\r\n}\r\nexport default App;\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}